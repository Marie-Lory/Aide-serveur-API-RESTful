<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>CRUD Reservation - Catways</title>
    <link rel="stylesheet" href="./CRUD-reservation.css">
</head>
<body>

<h1>Opérations CRUD pour Reservation - Catways</h1>

<!-- 1. Créer une réservation -->
<div class="section" id="create">
    <h2>Créer une nouvelle réservation</h2>
    <form action="/reservations" method="POST">
        <label for="catwayNumber">Numéro de catway :</label>
        <input type="text" id="catwayNumber" name="catwayNumber" required />

        <label for="clientName">Nom du client :</label>
        <input type="text" id="clientName" name="clientName" required />

        <label for="boatName">Nom du bateau :</label>
        <input type="text" id="boatName" name="boatName" required />

        <label for="startDate">Date de début :</label>
        <input type="date" id="startDate" name="startDate" required />

        <label for="endDate">Date de fin :</label>
        <input type="date" id="endDate" name="endDate" required />

        <button type="submit">Créer</button>
    </form>
</div>

<!-- 2. Lire (Afficher) toutes les réservations -->
<div class="section" id="read-all">
    <h2>Liste de toutes les réservations</h2>
    <% if (reservations && reservations.length > 0) { %>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Numéro Catway</th>
                    <th>Nom Client</th>
                    <th>Nom Bateau</th>
                    <th>Date Début</th>
                    <th>Date Fin</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <% reservations.forEach(function(reservation) { %>
                    <tr>
                        <td><%= reservation._id %></td>
                        <td><%= reservation.catwayNumber %></td>
                        <td><%= reservation.clientName %></td>
                        <td><%= reservation.boatName %></td>
                        <td><%= reservation.startDate.toISOString().slice(0,10) %></td>
                        <td><%= reservation.endDate.toISOString().slice(0,10) %></td>
                        <td>
                            <!-- Lien pour voir détails d'une réservation spécifique -->
                            <form action="/reservations/<%= reservation._id %>" method="GET" style="display:inline;">
                                <button type="submit">Voir</button>
                            </form>
                            <!-- Lien pour éditer une réservation -->
                            <form action="/reservations/<%= reservation._id %>/edit" method="GET" style="display:inline;">
                                <button type="submit">Éditer</button>
                            </form>
                            <!-- Lien pour supprimer une réservation -->
                            <form action="/reservations/<%= reservation._id %>?_method=DELETE" method="POST" style="display:inline;">
                                <button type="submit" onclick="return confirm('Voulez-vous vraiment supprimer cette réservation ?');">Supprimer</button>
                            </form>
                        </td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    <% } else { %>
        <p>Aucune réservation trouvée.</p>
    <% } %>
</div>

<!-- 3. Voir détails d'une réservation spécifique -->
<div class="section" id="read-one">
    <h2>Détails de la réservation</h2>
    <% if (reservation) { %>
        <ul>
            <li><strong>ID :</strong> <%= reservation._id %></li>
            <li><strong>Numéro de catway :</strong> <%= reservation.catwayNumber %></li>
            <li><strong>Nom du client :</strong> <%= reservation.clientName %></li>
            <li><strong>Nom du bateau :</strong> <%= reservation.boatName %></li>
            <li><strong>Date de début :</strong> <%= reservation.startDate.toISOString().slice(0,10) %></li>
            <li><strong>Date de fin :</strong> <%= reservation.endDate.toISOString().slice(0,10) %></li>
        </ul>
        <a href="#read-all">Retour à la liste</a>
    <% } else { %>
        <p>Sélectionnez une réservation pour voir ses détails.</p>
    <% } %>
</div>

<!-- 4. Mettre à jour une réservation -->
<div class="section" id="update">
    <h2>Mettre à jour une réservation</h2>
    <% if (reservationToUpdate) { %>
        <form action="/reservations/<%= reservationToUpdate._id %>?_method=PUT" method="POST">
            <label for="catwayNumber">Numéro de catway :</label>
            <input type="text" id="catwayNumber" name="catwayNumber" value="<%= reservationToUpdate.catwayNumber %>" required />

            <label for="clientName">Nom du client :</label>
            <input type="text" id="clientName" name="clientName" value="<%= reservationToUpdate.clientName %>" required />

            <label for="boatName">Nom du bateau :</label>
            <input type="text" id="boatName" name="boatName" value="<%= reservationToUpdate.boatName %>" required />

            <label for="startDate">Date de début :</label>
            <input type="date" id="startDate" name="startDate" value="<%= reservationToUpdate.startDate.toISOString().slice(0,10) %>" required />

            <label for="endDate">Date de fin :</label>
            <input type="date" id="endDate" name="endDate" value="<%= reservationToUpdate.endDate.toISOString().slice(0,10) %>" required />

            <button type="submit">Mettre à jour</button>
        </form>
    <% } else { %>
        <p>Sélectionnez une réservation à modifier.</p>
    <% } %>
</div>

<!-- 5. Supprimer une réservation -->
<div class="section" id="delete">
    <h2>Supprimer une réservation</h2>
    <% if (reservationToDelete) { %>
        <p>Voulez-vous vraiment supprimer la réservation pour <strong><%= reservationToDelete.clientName %></strong> sur le bateau <strong><%= reservationToDelete.boatName %></strong> ?</p>
        <form action="/reservations/<%= reservationToDelete._id %>?_method=DELETE" method="POST">
            <button type="submit" onclick="return confirm('Confirmez la suppression ?');">Confirmer la suppression</button>
        </form>
    <% } else { %>
        <p>Sélectionnez une réservation à supprimer.</p>
    <% } %>
</div>

</body>
</html>